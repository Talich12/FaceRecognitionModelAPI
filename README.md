# FaceRecognitionModelAPI
## Основа модели
Для вычесления ембендингов лиц была использована модель InsightFace https://github.com/deepinsight/insightface/tree/master. Из-за ограниченного количества данных в датасете за модель класификатора была использован KNN, в будущем при больших обучающих данных иожно использовать CatBoost или нейронную сеть
## Суть модели
Модель создана для задачи индетификации сотрудника при входе в офис или в кабинет.
## Релизация
1. Для начала были получены эмбендинги лиц нашей команды (в датасете было по 15 фотографий каждого человека). Чтобы это сделать была проделана операция подготовки данных виде кропа лиц с фотографии с помощью библиотеки face_recognition:
2. Была обучена модель KNN для распознания человека на основе векторного представления идентичности человеческого лица. 
3. В ходе предсказания модель подгатавливает входные данные и находит ембендинг лица, далее модель сравнивает эти значения с другими ембендингами которые у нее хранятся внутри. При близком сходстве ембендингов модель делает предсказание человека, если сходство не слишком близкое модель указывает что такого человека нет в базе
4. Преоброзавание в API для того чтобы моделью можно было пользоваться была модель была реализована в микрофреймворке Flask
## Результаты
![Текст с описанием картинки](/result/jena.png)
![Текст с описанием картинки](/result/lera.png)
![Текст с описанием картинки](/result/roma.png)
![Текст с описанием картинки](/result/pasha.png)
# Запуск
## Установка
```bash
pip install flask flask_cors face_recognition Pillow numpy onnxruntime insightface 
```
## Запуск
```bash
python3 run.py 
```
